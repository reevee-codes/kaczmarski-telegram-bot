1) keep history of messages
2) better test coverage
3) refactor